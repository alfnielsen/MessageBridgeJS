## 0.2.0

More or less a rewrite of internals, but the API is almost the same.

- Add promise pattern (in addition to callback)\*
- Add requestMessage to response/resolve callback\*
- Add full flow test with async server call
- Removed _subscribeQuery\*\*_

\*Full track for handling of multiple of (the same or different) requests, so it's possible to use Promise.all etc.

_\*\*subscribeQuery was more or less unnecessary abstraction of subscribeEvent, and it do not support the new promise pattern._
_There are en example in the example folder for subscribe query is needed_

```ts
// before: (and now! you can still do it this way)
bridge.sendQuery({ name, payload, onSuccess, onError })

// new option:
const { response, request } = await bridge.sendQuery({
  name,
  payload,
  onSuccess,
  onError,
})
```

### Breaking changes

Almost no changes to the base: **sendQuery**, **sendCommand**, **sendEvent**, **subscribeEvent**

But response-methods now includes the request that spawned them (So the old 2 arg is now 3 arg)

```ts
// before
bridge.sendQuery({
  name,
  payload,
  onSuccess(response, responseMsg) {},
})
// after
bridge.sendQuery({
  name,
  payload,
  onSuccess(response, request, responseMsg, requestMsg) {},
})
// or the new option:
const { response, request, responseMsg, requestMsg } = await bridge.sendQuery({
  name,
  payload,
})
```

**subscribeQuery** is removed !

- "helper" (static methods) has been moved to a separate file

Optimize Message by removing "class" version and only use interface (typescript type).

**trackId** is optional but it will be create by createMessage, createCommandMessage and createQueryMessage. _(Helper methods)_

You can still create the id, but it's not recommended.

> The **trackId** must be unique for each message, and is generated by the createMessage helper method. _(Using 'uuid' module)_

If you need the message (fx its trackId) before it's sent:

```ts
// From:
bridge.sendCommand(name, payload)

// To: (custom send where message is created before sent)
const msg = createCommandMessage({ name, payload, module })
bridge.sendMessage(msg)
```

### Optional breaking changes

If you extends the MessageBridgeServiceBase class, the subscriptions lists has change names to be more descriptive.

- Some internal names has changed

## 0.1.12

Add onClose

## 0.1.11

Export alle message bridge types from index.js (index.ts),
to avoid multiple import of message bridge elements

## 0.1.10

Add debugLogging filters:

- messageReceivedFilter = undefined (undefined | string RegExp)
- sendingMessageFilter = undefined (undefined | string RegExp)

It filter's message names (Only log messages with matching name)

```ts
// EX:
messageBridge.debugLogging.messageReceivedFilter = /^area/
```

## 0.1.9

module (as optional string) is added to the message interface (and create methods)

## 0.1.5 message-bridge-js@commonjs

Publish a commonjs build under tag @commonjs

To install `npm i message-bridge-js@commonjs` or `yarn add message-bridge-js@commonjs`

## 0.1.0-4

Split into a base class `MessageBridgeServiceBase` an different network implementations.

There are now two network implementations:

- SignalRMessageBridgeService (MessageBridgeService)
- WebSocketConnectionService

The exprted `MessageBridgeService` is the SignalRMessageBridgeService - `So no real changes except the onError`

### Breaking changes

- onError now take an 'Error' instead of a 'string'

## 0.0.10

Add **onError** on subscribeQuery

## 0.0.5

Add **options?: IHttpConnectionOptions** on **connect** method

## 0.0.2

Add cdn build (for direct use in a browser)

https://unpkg.com/message-bridge-js/cdn-build/MessageBridgeService.js

## 0.0.1

Initial version
