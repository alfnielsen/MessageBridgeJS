{"version":3,"file":"index.umd.js","sources":["../src/MessageBridgeInterfaces.ts","../src/Message.ts","../src/MessageBridgeServiceBase.ts","../src/SignalRMessageBridgeService.ts","../src/WebsocketMessageBridgeService.ts"],"sourcesContent":["import { Message } from \"./Message\"\n\nexport enum MessageType {\n  Command = \"Command\",\n  CommandResponse = \"CommandResponse\", // null or created id (number)\n  Query = \"Query\",\n  QueryResponse = \"QueryResponse\",\n  Event = \"Event\",\n  Error = \"Error\",\n}\n\nexport type SubscribeResponse<TMessageType> = (\n  payload: TMessageType,\n  bridgeMessage: Message<TMessageType>,\n) => void\n\nexport type SubscribeResponseWithCatch<TMessageType, TErrorMessageType = any> = {\n  onSuccess?: SubscribeResponse<TMessageType>\n  onError?: SubscribeResponse<TErrorMessageType>\n}\n\nexport interface IMessageServiceQuerySubscription<TQuery, TResponse> {\n  module?: string\n  name: string\n  query: TQuery\n  triggers: string[]\n  onUpdate: SubscribeResponse<TResponse>\n  onError?: SubscribeResponse<any>\n}\n\nexport enum MessageDirection {\n  ToClient = \"ToClient\",\n  ToServer = \"ToServer\",\n}\n","import { v4 as uuidv4 } from \"uuid\"\nimport { MessageDirection, MessageType } from \"./MessageBridgeInterfaces\"\n\nexport class Message<TPayload = any, TResponse = any, TSchema = any> {\n  public module?: string\n  public name: string\n  public type: MessageType\n  public isError: boolean\n  public trackId: string\n  public created: string\n  public payload?: TPayload\n  public schema?: TSchema\n  public direction: MessageDirection\n  constructor(\n    name: string,\n    type: MessageType,\n    payload?: TPayload,\n    schema?: TSchema,\n    trackId = uuidv4(),\n    created = new Date(Date.now()).toJSON(),\n    direction = MessageDirection.ToServer,\n    module?: string,\n  ) {\n    this.module = module\n    this.name = name\n    this.type = type\n    this.trackId = trackId\n    this.created = created\n    this.payload = payload\n    this.schema = schema\n    this.direction = direction\n    this.isError = type === MessageType.Error\n  }\n\n  static create<TPayload = any, TResponse = any, TSchema = any>(opt: {\n    name: string\n    type: MessageType\n    payload?: TPayload\n    schema?: TSchema\n    trackId?: string\n    created?: string\n    direction?: MessageDirection\n    module?: string\n  }) {\n    return new Message<TPayload, TResponse, TSchema>(\n      opt.name,\n      opt.type,\n      opt.payload,\n      opt.schema,\n      opt.trackId,\n      opt.created,\n      opt.direction,\n      opt.module,\n    )\n  }\n\n  static fromDto<TPayload = any, TResponse = any, TSchema = any>(\n    msg: Message<TPayload, TResponse, TSchema>,\n    direction = MessageDirection.ToClient,\n  ): Message<TPayload, TResponse, TSchema> {\n    return new Message<TPayload, TResponse, TSchema>(\n      msg.name,\n      msg.type,\n      msg.payload,\n      msg.schema,\n      msg.trackId,\n      msg.created,\n      direction,\n      msg.module,\n    )\n  }\n}\n","import * as signalR from \"@microsoft/signalr\"\nimport { Message } from \"./Message\"\nimport {\n  IMessageServiceQuerySubscription,\n  MessageDirection,\n  MessageType,\n  SubscribeResponse,\n  SubscribeResponseWithCatch,\n} from \"./MessageBridgeInterfaces\"\n\nexport abstract class MessageBridgeServiceBase {\n  connected = false\n  connection?: signalR.HubConnection\n  debugLogger: (...data: any[]) => void = window?.console.log || (() => {}) // set custom logger\n  debugLogging = {\n    messageReceived: false,\n    sendingMessage: false,\n    messageReceivedFilter: undefined as undefined | string | RegExp,\n    sendingMessageFilter: undefined as undefined | string | RegExp,\n  }\n\n  constructor(public wsUri: string) {}\n\n  abstract connect(options?: unknown): Promise<void>\n  abstract sendNetworkMessage(msg: Message): void\n\n  // return this.connection.start();\n\n  protected onMessage(messageString: string | Message) {\n    let messageDto: Message\n    try {\n      messageDto =\n        typeof messageString === \"string\"\n          ? (JSON.parse(messageString) as Message)\n          : messageString\n    } catch (e) {\n      this.onError(e as Error)\n      console.log(\"Incorrect message received: \" + messageString)\n      return\n    }\n    try {\n      const msg = Message.fromDto(messageDto)\n      if (this.debugLogging.messageReceived) {\n        let log = true\n        if (this.debugLogging.messageReceivedFilter) {\n          log = !!msg.name.match(this.debugLogging.messageReceivedFilter)\n        }\n        if (log) {\n          this.debugLogger(\"Bridge (messageReceived): \", msg)\n        }\n      }\n      this.handleIncomingMessage(msg)\n    } catch (e) {\n      console.log(\"Error in response handle for message: \" + e)\n    }\n  }\n\n  protected subscriptionTrackIdList: {\n    [trackId: string]: SubscribeResponseWithCatch<any>\n  } = {}\n\n  protected subscriptionEventList: {\n    [eventName: string]: SubscribeResponse<any>[]\n  } = {}\n\n  protected subscriptionQuery: IMessageServiceQuerySubscription<any, any>[] = []\n\n  history: Message[] = []\n  bridgeErrors: (Error | string)[] = []\n\n  sendMessage<TPayload = any, TResponse = any, TSchema = any>(\n    msg: Message<TPayload, TResponse, TSchema>,\n    onSuccess?: SubscribeResponse<TResponse>,\n    onError?: SubscribeResponse<any>,\n  ) {\n    msg.direction = MessageDirection.ToServer\n    if (onSuccess || onError) {\n      this.subscriptionTrackIdList[msg.trackId] = { onSuccess, onError }\n    }\n    this.internalSendMessage(msg)\n  }\n\n  protected internalSendMessage(msg: Message) {\n    this.history.push(msg)\n    if (this.debugLogging.sendingMessage) {\n      let log = true\n      if (this.debugLogging.sendingMessageFilter) {\n        log = !!msg.name.match(this.debugLogging.sendingMessageFilter)\n      }\n      if (log) {\n        this.debugLogger(\"Bridge (sendingMessage): \", msg)\n      }\n    }\n    this.sendNetworkMessage(msg)\n  }\n\n  subscribeEvent<TResponse = any>({\n    name,\n    onEvent,\n  }: {\n    name: string\n    onEvent: SubscribeResponse<TResponse>\n  }) {\n    if (!this.subscriptionEventList[name]) this.subscriptionEventList[name] = []\n    this.subscriptionEventList[name].push(onEvent)\n    return () => {\n      const index = this.subscriptionEventList[name].findIndex((x) => x === onEvent)\n      this.subscriptionEventList[name].splice(index, 1)\n    }\n  }\n\n  createCommandMessage<TPayload = any, TResponse = any, TSchema = any>(\n    name: string,\n    payload: TPayload,\n    direction = MessageDirection.ToServer,\n    module?: string,\n  ) {\n    return Message.create<TPayload, TResponse, TSchema>({\n      name,\n      type: MessageType.Command,\n      payload,\n      direction,\n      module,\n    })\n  }\n\n  createQueryMessage<TPayload = any>(\n    name: string,\n    payload: TPayload,\n    direction = MessageDirection.ToServer,\n    module?: string,\n  ) {\n    return Message.create({\n      name,\n      type: MessageType.Query,\n      payload,\n      direction,\n      module,\n    })\n  }\n\n  createEventMessage<TPayload = any>(\n    name: string,\n    payload: TPayload,\n    direction = MessageDirection.ToServer,\n    module?: string,\n  ) {\n    return Message.create({\n      name,\n      type: MessageType.Event,\n      payload,\n      direction,\n      module,\n    })\n  }\n\n  sendCommand<TPayload = any, TResponse = any, TSchema = any>({\n    name,\n    payload,\n    onSuccess,\n    onError,\n    module,\n  }: {\n    name: string\n    payload: TPayload\n    onSuccess?: SubscribeResponse<TResponse>\n    onError?: SubscribeResponse<any>\n    module?: string\n  }) {\n    const msg = this.createCommandMessage(name, payload, undefined, module)\n    this.sendMessage<TPayload, TResponse, TSchema>(msg, onSuccess, onError)\n    return msg\n  }\n\n  sendQuery<TPayload = any, TResponse = any, TSchema = any>({\n    name,\n    payload,\n    onSuccess,\n    onError,\n    module,\n  }: {\n    name: string\n    payload: TPayload\n    onSuccess?: SubscribeResponse<TResponse>\n    onError?: SubscribeResponse<any>\n    module?: string\n  }) {\n    const msg = this.createQueryMessage(name, payload, undefined, module)\n    this.sendMessage<TPayload, TResponse, TSchema>(msg, onSuccess, onError)\n    return msg\n  }\n\n  sendEvent<TPayload = any, TResponse = any, TSchema = any>({\n    name,\n    payload,\n    module,\n  }: {\n    name: string\n    payload: TPayload\n    module?: string\n  }) {\n    const msg = this.createEventMessage(name, payload, undefined, module)\n    this.sendMessage<TPayload, TResponse, TSchema>(msg)\n    return msg\n  }\n\n  subscribeQuery<TPayload = any, TResponse = any>(\n    opt: IMessageServiceQuerySubscription<TPayload, TResponse>,\n  ) {\n    //call right away\n    this.sendQuery({\n      name: opt.name,\n      payload: opt.query,\n      onSuccess: opt.onUpdate,\n      onError: opt.onError,\n      module: opt.module,\n    })\n    //then subscribe\n    this.subscriptionQuery.push(opt)\n\n    return /*unsubscribe*/ () => {\n      const index = this.subscriptionQuery.findIndex((x) => x === opt)\n      if (index > 0) {\n        this.subscriptionQuery.splice(index, 1)\n      }\n    }\n  }\n\n  // can be overwritten by consumer!\n  onError(err: Error) {\n    this.bridgeErrors.push(err)\n  }\n\n  handleIncomingMessage(msg: Message) {\n    this.history.push(msg)\n    if (this.subscriptionTrackIdList[msg.trackId]) {\n      if (msg.type === MessageType.Error) {\n        this.subscriptionTrackIdList[msg.trackId].onError?.(msg.payload, msg)\n      } else {\n        this.subscriptionTrackIdList[msg.trackId].onSuccess?.(msg.payload, msg)\n      }\n      delete this.subscriptionTrackIdList[msg.trackId]\n    }\n    if (msg.type === MessageType.Event) {\n      this.receiveEventMessage(msg)\n    }\n  }\n\n  protected receiveEventMessage(eventMsg: Message) {\n    if (this.subscriptionEventList[eventMsg.name]) {\n      this.subscriptionEventList[eventMsg.name].forEach((callback) =>\n        callback(eventMsg.payload, eventMsg),\n      )\n    }\n    this.subscriptionQuery\n      .filter((x) => x.triggers?.some((x) => x === eventMsg.name) ?? false)\n      .forEach((x) => {\n        const msg = this.createQueryMessage(x.name, x.query)\n        this.sendMessage(msg, x.onUpdate, x.onError)\n      })\n  }\n}\n","import * as signalR from \"@microsoft/signalr\"\nimport { Message } from \"./Message\"\nimport { IHttpConnectionOptions } from \"@microsoft/signalr/src/IHttpConnectionOptions\"\nimport { MessageBridgeServiceBase } from \"./MessageBridgeServiceBase\"\n\nexport class SignalRMessageBridgeService extends MessageBridgeServiceBase {\n  connect(options: IHttpConnectionOptions = {}): Promise<void> {\n    this.connection = new signalR.HubConnectionBuilder()\n      .withUrl(this.wsUri, options)\n      .withAutomaticReconnect()\n      .build()\n    this.connection.on(\"ReceiveMessage\", (messageString: string | Message) => {\n      this.onMessage(messageString)\n    })\n    return this.connection\n      .start()\n      .then(() => {\n        this.connected = true\n      })\n      .catch((err: Error) => {\n        this.onError(err)\n      })\n  }\n\n  sendNetworkMessage(msg: Message) {\n    const msgJson = JSON.stringify(msg)\n    this.connection?.invoke(\"SendMessage\", msgJson).catch((err) => {\n      this.onError(err as Error)\n      return console.error(err.toString())\n    })\n  }\n}\n","import { Message } from \"./Message\";\nimport { MessageBridgeServiceBase } from \"./MessageBridgeServiceBase\";\n\nexport class WebsocketMessageBridgeService extends MessageBridgeServiceBase {\n  socket?: WebSocket;\n  connectedCallback?: () => void;\n\n  connect() {\n    this.socket = new WebSocket(this.wsUri);\n    this.socket.addEventListener(\"message\", (event) => {\n      const messageString: string | Message = event.data;\n      this.onMessage(messageString);\n    });\n\n    return new Promise<void>((resolve, reject) => {\n      // Connection opened\n      this.socket?.addEventListener(\"open\", (event) => {\n        this.connected = true;\n        resolve();\n      });\n    });\n  }\n\n  sendNetworkMessage(msg: Message) {\n    const msgJson = JSON.stringify(msg);\n    this.socket?.send(msgJson);\n  }\n}\n"],"names":["MessageType","MessageDirection","Message","constructor","name","type","payload","schema","trackId","uuidv4","created","Date","now","toJSON","direction","ToServer","module","this","isError","Error","static","opt","msg","ToClient","MessageBridgeServiceBase","wsUri","connected","connection","debugLogger","window","console","log","debugLogging","messageReceived","sendingMessage","messageReceivedFilter","undefined","sendingMessageFilter","subscriptionTrackIdList","subscriptionEventList","subscriptionQuery","history","bridgeErrors","onMessage","messageString","messageDto","JSON","parse","e","onError","fromDto","match","handleIncomingMessage","sendMessage","onSuccess","internalSendMessage","push","sendNetworkMessage","subscribeEvent","onEvent","index","findIndex","x","splice","createCommandMessage","create","Command","createQueryMessage","Query","createEventMessage","Event","sendCommand","sendQuery","sendEvent","subscribeQuery","query","onUpdate","err","receiveEventMessage","eventMsg","forEach","callback","filter","triggers","some","connect","options","signalR","HubConnectionBuilder","withUrl","withAutomaticReconnect","build","on","start","then","catch","msgJson","stringify","invoke","error","toString","WebsocketMessageBridgeService","socket","connectedCallback","WebSocket","addEventListener","event","data","Promise","resolve","reject","send"],"mappings":"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"}